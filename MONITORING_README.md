# –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ API Kiddeo

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```bash
npm run init:logging
```

### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏—è
```bash
npm run dev:timeout
```

### 3. –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: http://localhost:3000/monitor
- **–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å**: http://localhost:3000/admin?key=kidsreview2025
- **API Health**: http://localhost:3000/api/health

## üìä –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –í—Å–µ API –∑–∞–ø—Ä–æ—Å—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ SQLite —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏ —Å—Ç–∞—Ç—É—Å –∫–æ–¥–æ–≤

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚è±Ô∏è –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- üö® –ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫
- üìä –°–∞–º—ã–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ä–æ—É—Ç—ã
- üíæ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SQLite
- ‚ö° WAL —Ä–µ–∂–∏–º –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- üîç –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- üßπ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤
- üìä –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üõ†Ô∏è API Endpoints

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- `GET /api/monitor?type=memory` - –î–∞–Ω–Ω—ã–µ –∏–∑ –ø–∞–º—è—Ç–∏ (–±—ã—Å—Ç—Ä–æ)
- `GET /api/monitor?type=database` - –î–∞–Ω–Ω—ã–µ –∏–∑ –ë–î (–ø–æ–ª–Ω–æ)
- `GET /api/monitor?type=health` - –ó–¥–æ—Ä–æ–≤—å–µ —Å–∏—Å—Ç–µ–º—ã
- `POST /api/monitor` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∞–º–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- `GET /api/optimize?action=stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ë–î
- `GET /api/optimize?action=optimize` - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ë–î
- `GET /api/optimize?action=cleanup&days=30` - –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- `GET /api/init?action=health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
- `GET /api/init?action=init` - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞
PORT=3000

# –•–æ—Å—Ç —Å–µ—Ä–≤–µ—Ä–∞
HOST=localhost

# URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
DATABASE_URL="file:./dev.db"
```

### –¢–∞–π–º–∞—É—Ç—ã
- **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞**: 15 —Å–µ–∫—É–Ω–¥
- **API –∑–∞–ø—Ä–æ—Å—ã**: –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (–º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å)
- **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**: 5 —Å–µ–∫—É–Ω–¥

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ú–µ—Ç—Ä–∏–∫–∏
- **Total Requests**: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- **Avg Duration**: –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **Error Rate**: –ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫
- **Status Codes**: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç–∞—Ç—É—Å –∫–æ–¥–∞–º
- **Slowest Routes**: –°–∞–º—ã–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ä–æ—É—Ç—ã

### –ò–Ω–¥–µ–∫—Å—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–°–æ–∑–¥–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è:
- `User` (email, role, createdAt)
- `Vendor` (userId, cityId, type, kycStatus)
- `Listing` (vendorId, cityId, categoryId, isActive, createdAt)
- `AfishaEvent` (city, status, startDate, isPopular)
- `VenuePartner` (vendorId, cityId, status, subcategoryId)
- `Order` (userId, vendorId, status, createdAt)
- `Payment` (userId, status, createdAt)
- `Notification` (userId, isRead, createdAt)
- `api_logs` (timestamp, pathname, status_code, duration, method)

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç 3000 (–º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–Ω—è—Ç)
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run init:logging`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

### –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
1. –û—Ç–∫—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: http://localhost:3000/monitor
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∫–ª–∞–¥–∫—É "Slowest Routes"
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é: `GET /api/optimize?action=optimize`

### –û—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∫–ª–∞–¥–∫—É "Recent Logs"
2. –§–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ —Å—Ç–∞—Ç—É—Å –∫–æ–¥–∞–º
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- **INFO**: –û–±—ã—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- **WARN**: –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (>1000ms)
- **ERROR**: –û—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ (4xx, 5xx)

### –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤
- –õ–æ–≥–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ (1000 –∑–∞–ø–∏—Å–µ–π)
- –°—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ 30 –¥–Ω–µ–π

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–º
- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –∑–∞—â–∏—â–µ–Ω–∞ –∫–ª—é—á–æ–º: `kidsreview2025`
- API endpoints –Ω–µ —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –ó–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `X-Content-Type-Options: nosniff`
- `X-Frame-Options: DENY`
- `X-XSS-Protection: 1; mode=block`

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
curl http://localhost:3000/api/health

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
curl http://localhost:3000/api/optimize?action=stats

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
curl -X POST http://localhost:3000/api/optimize -d '{"action":"optimize"}'

# –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤
curl -X POST http://localhost:3000/api/optimize -d '{"action":"cleanup","daysToKeep":7}'
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É**: `npm run dev:timeout`
2. **–û—Ç–∫—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: http://localhost:3000/monitor
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å**: http://localhost:3000/admin?key=kidsreview2025
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ API**: –°–¥–µ–ª–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤
5. **–ù–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –º–µ—Ç—Ä–∏–∫–∞–º–∏**: –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ API –∑–∞–ø—Ä–æ—Å—ã –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —É–∑–∫–∏—Ö –º–µ—Å—Ç –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
